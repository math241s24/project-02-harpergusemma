{
  "hash": "81481f637b2562b4cc8077dd37a106c8",
  "result": {
    "markdown": "::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(tidyverse)\nlibrary(tidytext)\nlibrary(textdata)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsalmon <- read_csv(\"salmondata/rawsalmon.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 1902 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Area, Species Name\ndbl (7): Year, Number Of Fish (estimated), Landed Weight (lbs), Whole Weight...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nsalmon <- salmon %>% rename(species = `Species Name`,\n                            num_fish = `Number Of Fish (estimated)`,\n                            land_weight = `Landed Weight (lbs)`,\n                            whole_weight = `Whole Weight (lbs)`,\n                            num_permit = `Permit Count`,\n                            num_processor = `Processor Count`,\n                            num_vessel = `Vessel Count`)\nwrite.csv(salmon, \"salmondata/salmon.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(salmon, aes(x = Year, y = num_fish)) +\n  geom_col(stat = \"identity\", aes(fill = species), bins = 30) +\n  labs(y = \"Number of landed fish\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_col(stat = \"identity\", aes(fill = species), bins = 30):\nIgnoring unknown parameters: `stat` and `bins`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 284 rows containing missing values or values outside the scale range\n(`geom_col()`).\n```\n:::\n\n::: {.cell-output-display}\n![](DataWrangling_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfishes <- data.frame(\n  legislature = c(18, 19, 20, 21, 22, 23, 24, 25, 26, 27), \n  fishcount = c(88, 133, 280, 149, 120, 54, 161, 91, 31, 22), \n  year = c(1993, 1995, 1997, 1999, 2001, 2003, 2005, 2007, 2009, 2011)\n)\n\nsockeye <- salmon %>%\n  filter(species == \"Sockeye Salmon\")\n\nfishsockeye <- right_join(fishes, sockeye, by = c(\"year\" = \"Year\"))\nview(fishsockeye)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfishandgame <- read.csv(\"fish_and_game.csv\")\nfishandgame <- fishandgame %>%\n  mutate(Year = case_when(\n    Legislature == 33 ~ 2023,\n    Legislature == 32 ~ 2021,\n    Legislature == 31 ~ 2019,\n    Legislature == 30 ~ 2017,\n    Legislature == 29 ~ 2015,\n    Legislature == 28 ~ 2013,\n    Legislature == 27 ~ 2011,\n    Legislature == 26 ~ 2009,\n    Legislature == 25 ~ 2007,\n    Legislature == 24 ~ 2005,\n    Legislature == 23 ~ 2003,\n    Legislature == 22 ~ 2001,\n    Legislature == 21 ~ 1999,\n    Legislature == 20 ~ 1997,\n    Legislature == 19 ~ 1995,\n    Legislature == 18 ~ 1993,\n    Legislature == 17 ~ 1991,\n    Legislature == 16 ~ 1989,\n    Legislature == 15 ~ 1987,\n    Legislature == 14 ~ 1985,\n  ))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfishandgame <- fishandgame %>%\n  mutate(FULL_TEXT = tolower(FULL_TEXT)) %>%\n  mutate(FULL_TEXT = gsub(\"[[:punct:]]\", \"\", FULL_TEXT),\n         FULL_TEXT = str_replace_all(FULL_TEXT, \"\\\\b\\\\d+\\\\b\", \"\"),\n        FULL_TEXT = str_replace_all(FULL_TEXT, \"\\\\b\\\\w*\\\\d+\\\\w*\\\\b\", \"\"))\n\n\n tokenized_fishandgame <- fishandgame %>%\n  unnest_tokens(word, FULL_TEXT)\n \n data(\"stop_words\")\n stopfishandgame <- tokenized_fishandgame %>%\n   anti_join(stop_words)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(word)`\n```\n:::\n\n```{.r .cell-code}\nsalmontextanalysisdf <- inner_join(stopfishandgame, salmon, by = \"Year\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in inner_join(stopfishandgame, salmon, by = \"Year\"): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 1862 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n```\n:::\n\n```{.r .cell-code}\nthreshold <- 50000\n\nsalmontextanalysisdf %>%\n  count(word, sort = TRUE) %>%\n  filter(n > threshold) %>%\n  ggplot(aes(y = fct_reorder(word, n), x = n, fill = log(n))) +\n  geom_col(show.legend = FALSE) +\n  labs(\n    title = \"Frequency of words in Alaska Department of Fish and Game bills\",\n    subtitle = \"Words occurring more than 50,000 times\",\n    y = NULL, x = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](DataWrangling_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlegis <- read_csv(\"fish_and_game.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 428 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): Name, Link, FULL_TEXT\ndbl (1): Legislature\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nleng <- length(legis$Legislature)\n\ngetti <- function(word){\n  word_freq <- c()\n  for (i in 1:leng){ \n    legis_line <- legis$FULL_TEXT[i] %>%\n    str_split(\"(?<=\\\\.)\\\\s*\") %>% # specify the end-of-line character(s)\n    pluck(1) \n    word_freq_i <- legis_line %>%\n    str_subset(word) %>%\n    length()\n    #message(word_freq_i) #only to check it works\n    word_freq <- append(word_freq, word_freq_i)\n  }\n  return(word_freq)\n}\n\nlegis_word <- legis %>%\n  mutate(fish = getti(\"[F/f]ish\")) %>%\n  mutate(fisheries = getti(\"[F/f]isher[ies/y]\")) %>%\n  mutate(permit = getti(\"[P/p]ermit\")) %>%\n  mutate(vessel = getti(\"[V/v]essel\")) %>%\n  mutate(salmon = getti(\"[S/s]almon\")) %>%\n  mutate(limit = getti(\"[L/l]imit\")) \nlegis_word_longer <- legis_word %>% \n  select(-FULL_TEXT) %>%\n  pivot_longer(c('fish', 'fisheries', 'permit', 'vessel', 'salmon', 'limit'), names_to = \"word\", values_to = \"times_mentioned\") %>%\n  mutate(Year = Legislature) %>%\n  mutate(Year = case_when(\n    Legislature == 33 ~ 2023,\n    Legislature == 32 ~ 2021,\n    Legislature == 31 ~ 2019,\n    Legislature == 30 ~ 2017,\n    Legislature == 29 ~ 2015,\n    Legislature == 28 ~ 2013,\n    Legislature == 27 ~ 2011,\n    Legislature == 26 ~ 2009,\n    Legislature == 25 ~ 2007,\n    Legislature == 24 ~ 2005,\n    Legislature == 23 ~ 2003,\n    Legislature == 22 ~ 2001,\n    Legislature == 21 ~ 1999,\n    Legislature == 20 ~ 1997,\n    Legislature == 19 ~ 1995,\n    Legislature == 18 ~ 1993,\n    Legislature == 17 ~ 1991,\n    Legislature == 16 ~ 1989,\n    Legislature == 15 ~ 1987,\n    Legislature == 14 ~ 1985\n  ))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwordplot <- ggplot(data = legis_word_longer, aes(x = Year, y = times_mentioned, fill = word)) +\n  geom_bar(position='stack', stat='identity') +\n  theme_minimal() + \n  labs(\n    title = \"Frequency of Keywords in Alaska State Legislature by Year\", \n    x = \"Year\", \n    y = \"Frequency\"\n  )\nwordplot\n```\n\n::: {.cell-output-display}\n![](DataWrangling_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nyearly_word <- legis_word_longer %>%\n  group_by(Year, word) %>%\n  summarise(count = sum(times_mentioned))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Year'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nglimpse(yearly_word)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 96\nColumns: 3\nGroups: Year [16]\n$ Year  <dbl> 1993, 1993, 1993, 1993, 1993, 1993, 1995, 1995, 1995, 1995, 1995…\n$ word  <chr> \"fish\", \"fisheries\", \"limit\", \"permit\", \"salmon\", \"vessel\", \"fis…\n$ count <int> 92, 8, 1, 18, 7, 0, 138, 10, 8, 60, 16, 0, 317, 91, 38, 103, 7, …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nyearlyplot <- ggplot(data = yearly_word, aes(x = Year, y = count, color = word)) +\n  geom_line() +\n  theme_minimal() + \n  labs(\n    title = \"Frequency of Keywords in Alaska State Legislature by Year\", \n    x = \"Year\", \n    y = \"Frequency\"\n  )\nyearlyplot\n```\n\n::: {.cell-output-display}\n![](DataWrangling_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"yearlyplot.png\", yearlyplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSaving 7 x 5 in image\n```\n:::\n:::\n",
    "supporting": [
      "DataWrangling_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}