theme_minimal() +
labs(
title = "Frequency of Keywords in Alaska State Legislature by Year",
x = "Year",
y = "Frequency"
)
# Load necessary libraries
library(tidyverse)
library(tidytext)
runApp('salmonapp')
runApp('salmonapp')
```{r, message=FALSE, warning=FALSE}
# Load necessary libraries
library(tidyverse)
library(tidytext)
library(textdata)
salmon <- read_csv("salmondata/rawsalmon.csv")
salmon <- salmon %>% rename(species = `Species Name`,
num_fish = `Number Of Fish (estimated)`,
land_weight = `Landed Weight (lbs)`,
whole_weight = `Whole Weight (lbs)`,
num_permit = `Permit Count`,
num_processor = `Processor Count`,
num_vessel = `Vessel Count`)
write.csv(salmon, "salmondata/salmon.csv")
ggplot(salmon, aes(x = Year, y = num_fish)) +
geom_col(stat = "identity", aes(fill = species), bins = 30) +
labs(y = "Number of landed fish")
fishes <- data.frame(
legislature = c(18, 19, 20, 21, 22, 23, 24, 25, 26, 27),
fishcount = c(88, 133, 280, 149, 120, 54, 161, 91, 31, 22),
year = c(1993, 1995, 1997, 1999, 2001, 2003, 2005, 2007, 2009, 2011)
)
sockeye <- salmon %>%
filter(species == "Sockeye Salmon")
fishsockeye <- right_join(fishes, sockeye, by = c("year" = "Year"))
view(fishsockeye)
fishandgame <- read.csv("fish_and_game.csv")
fishandgame <- fishandgame %>%
mutate(Year = case_when(
Legislature == 33 ~ 2023,
Legislature == 32 ~ 2021,
Legislature == 31 ~ 2019,
Legislature == 30 ~ 2017,
Legislature == 29 ~ 2015,
Legislature == 28 ~ 2013,
Legislature == 27 ~ 2011,
Legislature == 26 ~ 2009,
Legislature == 25 ~ 2007,
Legislature == 24 ~ 2005,
Legislature == 23 ~ 2003,
Legislature == 22 ~ 2001,
Legislature == 21 ~ 1999,
Legislature == 20 ~ 1997,
Legislature == 19 ~ 1995,
Legislature == 18 ~ 1993,
Legislature == 17 ~ 1991,
Legislature == 16 ~ 1989,
Legislature == 15 ~ 1987,
Legislature == 14 ~ 1985,
))
fishandgame <- fishandgame %>%
mutate(FULL_TEXT = tolower(FULL_TEXT)) %>%
mutate(FULL_TEXT = gsub("[[:punct:]]", "", FULL_TEXT),
FULL_TEXT = str_replace_all(FULL_TEXT, "\\b\\d+\\b", ""),
FULL_TEXT = str_replace_all(FULL_TEXT, "\\b\\w*\\d+\\w*\\b", ""))
tokenized_fishandgame <- fishandgame %>%
unnest_tokens(word, FULL_TEXT)
data("stop_words")
stopfishandgame <- tokenized_fishandgame %>%
anti_join(stop_words)
salmontextanalysisdf <- inner_join(stopfishandgame, salmon, by = "Year")
threshold <- 50000
salmontextanalysisdf %>%
count(word, sort = TRUE) %>%
filter(n > threshold) %>%
ggplot(aes(y = fct_reorder(word, n), x = n, fill = log(n))) +
geom_col(show.legend = FALSE) +
labs(
title = "Frequency of words in Alaska Department of Fish and Game bills",
subtitle = "Words occurring more than 50,000 times",
y = NULL, x = NULL
)
legis <- read_csv("fish_and_game.csv")
leng <- length(legis$Legislature)
getti <- function(word){
word_freq <- c()
for (i in 1:leng){
legis_line <- legis$FULL_TEXT[i] %>%
str_split("(?<=\\.)\\s*") %>% # specify the end-of-line character(s)
pluck(1)
word_freq_i <- legis_line %>%
str_subset(word) %>%
length()
#message(word_freq_i) #only to check it works
word_freq <- append(word_freq, word_freq_i)
}
return(word_freq)
}
legis_word <- legis %>%
mutate(fish = getti("[F/f]ish")) %>%
mutate(fisheries = getti("[F/f]isher[ies/y]")) %>%
mutate(permit = getti("[P/p]ermit")) %>%
mutate(vessel = getti("[V/v]essel")) %>%
mutate(salmon = getti("[S/s]almon")) %>%
mutate(limit = getti("[L/l]imit"))
legis_word_longer <- legis_word %>%
select(-FULL_TEXT) %>%
pivot_longer(c('fish', 'fisheries', 'permit', 'vessel', 'salmon', 'limit'), names_to = "word", values_to = "times_mentioned") %>%
mutate(Year = Legislature) %>%
mutate(Year = case_when(
Legislature == 33 ~ 2023,
Legislature == 32 ~ 2021,
Legislature == 31 ~ 2019,
Legislature == 30 ~ 2017,
Legislature == 29 ~ 2015,
Legislature == 28 ~ 2013,
Legislature == 27 ~ 2011,
Legislature == 26 ~ 2009,
Legislature == 25 ~ 2007,
Legislature == 24 ~ 2005,
Legislature == 23 ~ 2003,
Legislature == 22 ~ 2001,
Legislature == 21 ~ 1999,
Legislature == 20 ~ 1997,
Legislature == 19 ~ 1995,
Legislature == 18 ~ 1993,
Legislature == 17 ~ 1991,
Legislature == 16 ~ 1989,
Legislature == 15 ~ 1987,
Legislature == 14 ~ 1985
))
wordplot <- ggplot(data = legis_word_longer, aes(x = Year, y = times_mentioned, fill = word)) +
geom_bar(position='stack', stat='identity') +
theme_minimal() +
labs(
title = "Frequency of Keywords in Alaska State Legislature by Year",
x = "Year",
y = "Frequency"
)
wordplot
yearly_word <- legis_word_longer %>%
group_by(Year, word) %>%
summarise(count = sum(times_mentioned))
glimpse(yearly_word)
yearlyplot <- ggplot(data = yearly_word, aes(x = Year, y = count, color = word)) +
geom_line() +
theme_minimal() +
labs(
title = "Frequency of Keywords in Alaska State Legislature by Year",
x = "Year",
y = "Frequency"
)
yearlyplot
library(shiny)
library(tidyverse)
library(readr)
library(bslib)
salmon <- read_csv("salmondata/salmon.csv")
ui <- page_sidebar(
sidebar = sidebar(
varSelectInput("xvar", "X variable", salmon, selected = "Year"),
varSelectInput("yvar", "Y variable", salmon, selected = "num_fish"),
checkboxGroupInput(
"species", "Filter by species",
choices = unique(salmon$species),
selected = unique(salmon$species)
),
hr(), # Add a horizontal rule
checkboxInput("by_species", "Show species", TRUE),
),
plotOutput("distPlot")
)
server <- function(input, output, session) {
subsetted <- reactive({
req(input$species)
salmon |> filter(species %in% input$species)
})
output$distPlot <- renderPlot({
p <- ggplot(subsetted(), aes(!!input$xvar, !!input$yvar)) + list(
theme(legend.position = "bottom"),
if (input$by_species) aes(fill = species),
geom_histogram(stat = "identity")
)
p
}, res = 100)
}
shinyApp(ui, server)
ggsave("yearlyplot.png", yearlyplot)
p <- ggplot(subsetted(), aes(!!input$xvar, !!input$yvar)) + list(
theme(legend.position = "bottom"),
if (input$by_species) aes(color = species),
geom_point(),
geom_smooth(method = 'lm'),
if (xvar="Time") geom_line(x = 2010)
runApp('salmonapp')
runApp('salmonapp')
runApp('salmonapp')
install.packages("quarto")
---
title: "Fish Shiny App"
git remote set-url origin https://eecamp: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@github.com/math241s24/project-02-harpergusemma.git
# Load necessary libraries
library(tidyverse)
library(tidytext)
library(textdata)
salmon <- read_csv("salmondata/rawsalmon.csv")
salmon <- salmon %>% rename(species = `Species Name`,
num_fish = `Number Of Fish (estimated)`,
land_weight = `Landed Weight (lbs)`,
whole_weight = `Whole Weight (lbs)`,
num_permit = `Permit Count`,
num_processor = `Processor Count`,
num_vessel = `Vessel Count`)
write.csv(salmon, "salmondata/salmon.csv")
ggplot(salmon, aes(x = Year, y = num_fish)) +
geom_col(stat = "identity", aes(fill = species), bins = 30) +
labs(y = "Number of landed fish")
fishes <- data.frame(
legislature = c(18, 19, 20, 21, 22, 23, 24, 25, 26, 27),
fishcount = c(88, 133, 280, 149, 120, 54, 161, 91, 31, 22),
year = c(1993, 1995, 1997, 1999, 2001, 2003, 2005, 2007, 2009, 2011)
)
sockeye <- salmon %>%
filter(species == "Sockeye Salmon")
fishsockeye <- right_join(fishes, sockeye, by = c("year" = "Year"))
view(fishsockeye)
fishandgame <- read.csv("fish_and_game.csv")
fishandgame <- fishandgame %>%
mutate(Year = case_when(
Legislature == 33 ~ 2023,
Legislature == 32 ~ 2021,
Legislature == 31 ~ 2019,
Legislature == 30 ~ 2017,
Legislature == 29 ~ 2015,
Legislature == 28 ~ 2013,
Legislature == 27 ~ 2011,
Legislature == 26 ~ 2009,
Legislature == 25 ~ 2007,
Legislature == 24 ~ 2005,
Legislature == 23 ~ 2003,
Legislature == 22 ~ 2001,
Legislature == 21 ~ 1999,
Legislature == 20 ~ 1997,
Legislature == 19 ~ 1995,
Legislature == 18 ~ 1993,
Legislature == 17 ~ 1991,
Legislature == 16 ~ 1989,
Legislature == 15 ~ 1987,
Legislature == 14 ~ 1985,
))
fishandgame <- fishandgame %>%
mutate(FULL_TEXT = tolower(FULL_TEXT)) %>%
mutate(FULL_TEXT = gsub("[[:punct:]]", "", FULL_TEXT),
FULL_TEXT = str_replace_all(FULL_TEXT, "\\b\\d+\\b", ""),
FULL_TEXT = str_replace_all(FULL_TEXT, "\\b\\w*\\d+\\w*\\b", ""))
tokenized_fishandgame <- fishandgame %>%
unnest_tokens(word, FULL_TEXT)
data("stop_words")
stopfishandgame <- tokenized_fishandgame %>%
anti_join(stop_words)
salmontextanalysisdf <- inner_join(stopfishandgame, salmon, by = "Year")
threshold <- 50000
salmontextanalysisdf %>%
count(word, sort = TRUE) %>%
filter(n > threshold) %>%
ggplot(aes(y = fct_reorder(word, n), x = n, fill = log(n))) +
geom_col(show.legend = FALSE) +
labs(
title = "Frequency of words in Alaska Department of Fish and Game bills",
subtitle = "Words occurring more than 50,000 times",
y = NULL, x = NULL
)
legis <- read_csv("fish_and_game.csv")
leng <- length(legis$Legislature)
getti <- function(word){
word_freq <- c()
for (i in 1:leng){
legis_line <- legis$FULL_TEXT[i] %>%
str_split("(?<=\\.)\\s*") %>% # specify the end-of-line character(s)
pluck(1)
word_freq_i <- legis_line %>%
str_subset(word) %>%
length()
#message(word_freq_i) #only to check it works
word_freq <- append(word_freq, word_freq_i)
}
return(word_freq)
}
legis_word <- legis %>%
mutate(fish = getti("[F/f]ish")) %>%
mutate(fisheries = getti("[F/f]isher[ies/y]")) %>%
mutate(permit = getti("[P/p]ermit")) %>%
mutate(vessel = getti("[V/v]essel")) %>%
mutate(salmon = getti("[S/s]almon")) %>%
mutate(limit = getti("[L/l]imit"))
legis_word_longer <- legis_word %>%
select(-FULL_TEXT) %>%
pivot_longer(c('fish', 'fisheries', 'permit', 'vessel', 'salmon', 'limit'), names_to = "word", values_to = "times_mentioned") %>%
mutate(Year = Legislature) %>%
mutate(Year = case_when(
Legislature == 33 ~ 2023,
Legislature == 32 ~ 2021,
Legislature == 31 ~ 2019,
Legislature == 30 ~ 2017,
Legislature == 29 ~ 2015,
Legislature == 28 ~ 2013,
Legislature == 27 ~ 2011,
Legislature == 26 ~ 2009,
Legislature == 25 ~ 2007,
Legislature == 24 ~ 2005,
Legislature == 23 ~ 2003,
Legislature == 22 ~ 2001,
Legislature == 21 ~ 1999,
Legislature == 20 ~ 1997,
Legislature == 19 ~ 1995,
Legislature == 18 ~ 1993,
Legislature == 17 ~ 1991,
Legislature == 16 ~ 1989,
Legislature == 15 ~ 1987,
Legislature == 14 ~ 1985
))
wordplot <- ggplot(data = legis_word_longer, aes(x = Year, y = times_mentioned, fill = word)) +
geom_bar(position='stack', stat='identity') +
theme_minimal() +
labs(
title = "Frequency of Keywords in Alaska State Legislature by Year",
x = "Year",
y = "Frequency"
)
wordplot
yearly_word <- legis_word_longer %>%
group_by(Year, word) %>%
summarise(count = sum(times_mentioned))
glimpse(yearly_word)
yearlyplot <- ggplot(data = yearly_word, aes(x = Year, y = count, color = word)) +
geom_line() +
theme_minimal() +
labs(
title = "Frequency of Keywords in Alaska State Legislature by Year",
x = "Year",
y = "Frequency"
)
yearlyplot
ggsave("yearlyplot.png", yearlyplot)
View(yearly_word)
View(salmon)
View(legis_word)
?piot_wider
?pivotwider
?pivot_wider
wordwide <- yearly_word %>% pivot_wider(names_from = word, values_from = count)
View(wordwide)
?outer_join
?inner_join
salmonword <- full_join(wordwide, salmon, by = join_by(Year))
View(salmonword)
ggplot(salmonword) +
geom_histogram(aes(x = Year, y = num_fish), stat = "identity") +
geom_line(aes(x = Year, y = fish))
ggplot(salmonword) +
geom_histogram(aes(x = Year, y = num_fish), stat = "identity", bins = 30) +
geom_line(aes(x = Year, y = fish))
ggplot(salmonword) +
geom_density(aes(x = Year, y = num_fish), stat = "identity", bins = 30)
salmonword$Year <- as.numeric(salmon$Year)
ggplot(salmonword) +
geom_density(aes(x = Year, y = num_fish), stat = "identity", bins = 30)
ggplot(salmonword) +
geom_histogram(aes(x = Year, y = num_fish), stat = "identity", bins = 30)
ggplot(salmonword) +
geom_histogram(aes(x = Year, y = num_fish), stat = "identity", breaks = 30)
coeff <- 10^7
ggplot(salmonword, aes(x=Year)) +
geom_line( aes(y=num_fish)) +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
coeff <- 10^6
ggplot(salmonword, aes(x=Year)) +
geom_line( aes(y=num_fish)) +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
coeff <- 10^5
ggplot(salmonword, aes(x=Year)) +
geom_hist( aes(y=num_fish)) +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish)) +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity") +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
coeff <- 10^6
ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity") +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
View(wordwide)
salmonword <- left_join(wordwide, salmon, by = join_by(Year))
coeff <- 10^6
ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity") +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
blue <- "cornflowerblue"
ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish, fill = blue), stat = "identity") +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity", fill = blue) +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
wordcomp <- ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity", fill = blue) +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
ggsave("wordsandfish.png", wordcomp)
wordcomp <- ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity", fill = blue) +
geom_line( aes(y=permit*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times permit mentioned in legislature")
)
ggsave("wordsandfish.png", wordcomp)
wordcomp <- ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity", fill = blue) +
geom_line( aes(y=fish*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times fish mentioned in legislature")
)
permitcomp <- ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity", fill = blue) +
geom_line( aes(y=permit*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times permit mentioned in legislature")
)
ggsave("wordsandfish.png", permitcomp)
ggsave("wordsandfish.png", wordcomp)
ggsave("wordsandfish.png", wordcomp)
permitcomp <- ggplot(salmonword, aes(x=Year)) +
geom_histogram( aes(y=num_fish), stat = "identity", fill = blue) +
geom_line( aes(y=permit*coeff)) + # Divide by 10 to get the same range than the temperature
scale_y_continuous(
# Features of the first axis
name = "Number of fish caught",
# Add a second axis and specify its features
sec.axis = sec_axis(~.*coeff, name="Number of times permit mentioned in legislature")
)
ggsave("wordsandpermit.png", permitcomp)
